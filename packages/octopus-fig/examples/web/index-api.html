<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <div style="width: 100px; height: 100px; border: 1px solid red" id="xxx"></div>
    <script src="../../release/web-umd.js"></script>
    <script>
      let i = 0 // Check main thread lags
      setInterval(() => {
        xxx.style.transform = `rotate(${(i += 5)}deg)`
      }, 30)

      window.addEventListener('DOMContentLoaded', async () => {
        const { createConverter, SourceApiReader } = OctopusFig

        const designId = 'aoZAhPTVzGi1rXnU35YPVb'
        const token = '376694-3ac3693b-cd97-4cd3-97b1-dc54aea109bf'
        const ids = []

        const readerOptions = {
          designId,
          token,
          ids,
          host: 'api.figma.com',
          pixelsLimit: 1e7,
          framePreviews: true,
          previewsParallels: 3,
          tokenType: 'personal',
          nodesParallels: 10,
          s3Parallels: 10,
          verbose: true,
          figmaIdsFetchUsedComponents: true,
          renderImagerefs: false,
          shouldObtainLibraries: true,
          shouldObtainStyles: true,
          parallelRequests: 5,
        }

        try {
          const converter = createConverter()
          const reader = new SourceApiReader(readerOptions)

          const designEmitter = reader.getSourceDesign()
          const result = await converter.convertDesign({ designEmitter })
          console.info('Result:', result)
        } catch (err) {
          console.error('Some error happened:', err)
        }
      })
    </script>
  </body>
</html>
